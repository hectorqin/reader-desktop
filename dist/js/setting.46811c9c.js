(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["setting"],{"4ef5":function(e,i,t){"use strict";t.r(i);var o=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"setting-wrapper",class:{night:e.isNight,day:!e.isNight}},[t("div",{staticClass:"navigation-wrapper",class:[e.navigationClass,e.isWebApp&&!e.isNight?"status-bar-light-bg":""],style:e.navigationStyle,on:{touchstart:e.handleTouchStart,touchmove:e.handleTouchMove,touchend:e.handleTouchEnd}},[t("div",{staticClass:"navigation-inner-wrapper"},[t("div",{staticClass:"navigation-title"},[e._v(" 阅读 "),t("span",{staticClass:"version-text"},[e._v(e._s(e.$store.state.version))])]),t("div",{staticClass:"navigation-sub-title"},[e._v(" 清风不识字，何故乱翻书 ")])])]),t("div",{ref:"shelfWrapper",staticClass:"setting-zone-wrapper",class:e.isWebApp&&!e.isNight?"status-bar-light-bg":"",on:{click:e.hideMenu}},[t("div",{staticClass:"setting-zone-title"},[e.$store.getters.isNormalPage&&e.collapseMenu?t("i",{staticClass:"el-icon-menu",on:{click:function(i){return i.stopPropagation(),e.toggleMenu.apply(null,arguments)}}}):e._e(),e._v(" 设置 "),t("div",{staticClass:"title-btn",on:{click:e.backToShelf}},[e._v(" 书架 ")])]),t("div",{staticClass:"setting-form-wrapper"},[t("el-form",{attrs:{model:e.windowConfigForm,"label-width":e.collapseMenu?"auto":"95px"}},[t("el-form-item",{attrs:{label:"Java路径"}},[t("el-input",{model:{value:e.windowConfigForm.javaPath,callback:function(i){e.$set(e.windowConfigForm,"javaPath",i)},expression:"windowConfigForm.javaPath"}})],1),t("el-form-item",{attrs:{label:"服务端口"}},[t("el-input",{model:{value:e.windowConfigForm.serverPort,callback:function(i){e.$set(e.windowConfigForm,"serverPort",i)},expression:"windowConfigForm.serverPort"}})],1),t("el-form-item",{attrs:{label:"服务配置"}},[t("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.windowConfigForm.serverConfig,callback:function(i){e.$set(e.windowConfigForm,"serverConfig",i)},expression:"windowConfigForm.serverConfig"}})],1),t("el-form-item",{attrs:{label:"窗口宽度"}},[t("el-input",{model:{value:e.windowConfigForm.width,callback:function(i){e.$set(e.windowConfigForm,"width",i)},expression:"windowConfigForm.width"}})],1),t("el-form-item",{attrs:{label:"窗口高度"}},[t("el-input",{model:{value:e.windowConfigForm.height,callback:function(i){e.$set(e.windowConfigForm,"height",i)},expression:"windowConfigForm.height"}})],1),t("el-form-item",{attrs:{label:"横坐标"}},[t("el-input",{model:{value:e.windowConfigForm.positionX,callback:function(i){e.$set(e.windowConfigForm,"positionX",i)},expression:"windowConfigForm.positionX"}})],1),t("el-form-item",{attrs:{label:"纵坐标"}},[t("el-input",{model:{value:e.windowConfigForm.positionY,callback:function(i){e.$set(e.windowConfigForm,"positionY",i)},expression:"windowConfigForm.positionY"}})],1),t("el-form-item",{attrs:{label:"页面链接"}},[t("el-input",{model:{value:e.windowConfigForm.windowUrl,callback:function(i){e.$set(e.windowConfigForm,"windowUrl",i)},expression:"windowConfigForm.windowUrl"}})],1),t("el-form-item",{attrs:{label:"调试页面"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":!0,"inactive-value":!1},model:{value:e.windowConfigForm.debug,callback:function(i){e.$set(e.windowConfigForm,"debug",i)},expression:"windowConfigForm.debug"}})],1),t("el-form-item",{attrs:{label:"其他配置"}},[t("el-checkbox",{model:{value:e.windowConfigForm.rememberSize,callback:function(i){e.$set(e.windowConfigForm,"rememberSize",i)},expression:"windowConfigForm.rememberSize"}},[e._v("记住窗口大小")]),t("el-checkbox",{model:{value:e.windowConfigForm.setWindowSize,callback:function(i){e.$set(e.windowConfigForm,"setWindowSize",i)},expression:"windowConfigForm.setWindowSize"}},[e._v("启动时设置窗口大小")]),t("el-checkbox",{model:{value:e.windowConfigForm.rememberPosition,callback:function(i){e.$set(e.windowConfigForm,"rememberPosition",i)},expression:"windowConfigForm.rememberPosition"}},[e._v("记住窗口位置")]),t("el-checkbox",{model:{value:e.windowConfigForm.setWindowPosition,callback:function(i){e.$set(e.windowConfigForm,"setWindowPosition",i)},expression:"windowConfigForm.setWindowPosition"}},[e._v("启动时设置窗口位置")])],1),t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveConfig}},[e._v("保存并重启")])],1)],1)],1)])])},n=[],a=t("c7eb"),s=t("1da1"),r=t("5530"),c=(t("e9c4"),t("ac1f"),t("5319"),t("e25e"),t("acd8"),t("4795"),t("2f62")),l={data:function(){return{showNavigation:!1,navigationClass:"",navigationStyle:{},windowConfigForm:{javaPath:"",serverPort:8080,width:1280,height:800,positionX:0,positionY:0,rememberSize:!0,rememberPosition:!1,setWindowSize:!0,setWindowPosition:!1,serverConfig:"{\n\n}"}}},created:function(){var e=this;window.__TAURI__&&window.__TAURI__.invoke&&window.__TAURI__.invoke("get_config").then((function(i){i.serverConfig=JSON.stringify(i.serverConfig,null,4),e.windowConfigForm=Object(r["a"])({},i)}))["catch"]((function(){})),window.settingPage=this,this.navigationClass=this.collapseMenu&&!this.showNavigation?"navigation-hidden":""},computed:Object(r["a"])({},Object(c["b"])(["isNight","collapseMenu"])),methods:{handleTouchStart:function(e){this.lastTouch=!1,this.lastMoveX=!1,this.touchMoveTimes=0,e.touches&&e.touches[0]&&e.touches[0].clientX>20&&e.touches[0].clientX<window.innerWidth-20&&e.touches[0].clientY>20&&e.touches[0].clientY<window.innerHeight-20&&(this.lastTouch=e.touches[0])},handleTouchMove:function(e){if(e.touches&&e.touches[0]&&this.lastTouch&&this.collapseMenu){var i=e.touches[0].clientX-this.lastTouch.clientX,t=e.touches[0].clientY-this.lastTouch.clientY;if(Math.abs(t)>Math.abs(i))return this.navigationStyle={},void(this.lastMoveX=0);e.preventDefault(),e.stopPropagation(),!this.showNavigation&&i>0&&i<=270?(this.touchMoveTimes%3===0&&(this.navigationStyle={marginLeft:i-270+"px"}),this.lastMoveX=i):this.showNavigation&&i<0&&i>=-270&&(this.touchMoveTimes%3===0&&(this.navigationStyle={marginLeft:i+"px"}),this.lastMoveX=i),this.touchMoveTimes++}},handleTouchEnd:function(){this.collapseMenu&&(this.lastMoveX>0?(this.showNavigation=!0,this.navigationStyle={}):this.lastMoveX<0&&(this.showNavigation=!1,this.navigationStyle={}))},hideMenu:function(){this.$store.getters.isNormalPage&&this.collapseMenu&&(this.showNavigation=!1)},toggleMenu:function(){this.collapseMenu&&(this.showNavigation=!this.showNavigation)},backToShelf:function(){var e=this;return Object(s["a"])(Object(a["a"])().mark((function i(){var t;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!window.__TAURI__||!window.__TAURI__.invoke){i.next=6;break}return i.next=3,window.__TAURI__.invoke("check_java",{javaPath:e.windowConfigForm.javaPath||""})["catch"]((function(i){return e.$message.error("未检测到 Java 运行环境，请确认 Java 路径设置是否正确 "+i),!1}));case 3:if(t=i.sent,t){i.next=6;break}return i.abrupt("return");case 6:e.$router.replace("/");case 7:case"end":return i.stop()}}),i)})))()},saveConfig:function(){var e=this;return Object(s["a"])(Object(a["a"])().mark((function i(){var t,o,n;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t=Object(r["a"])(Object(r["a"])({},e.windowConfigForm),{},{serverPort:parseInt(e.windowConfigForm.serverPort),width:parseFloat(e.windowConfigForm.width),height:parseFloat(e.windowConfigForm.height),positionX:parseFloat(e.windowConfigForm.positionX),positionY:parseFloat(e.windowConfigForm.positionY)}),!(t.serverPort<=0||t.serverPort>=65536)){i.next=4;break}return e.$message.error("服务端口只能在 0-65536"),i.abrupt("return");case 4:if(!(isNaN(t.width)||t.width<=0)){i.next=7;break}return e.$message.error("窗口宽度必须大于0"),i.abrupt("return");case 7:if(!(isNaN(t.height)||t.height<=0)){i.next=10;break}return e.$message.error("窗口高度必须大于0"),i.abrupt("return");case 10:if(!(isNaN(t.positionX)||t.positionX<=0)){i.next=13;break}return e.$message.error("窗口横坐标必须大于0"),i.abrupt("return");case 13:if(!(isNaN(t.positionY)||t.positionY<=0)){i.next=16;break}return e.$message.error("窗口纵坐标必须大于0"),i.abrupt("return");case 16:i.prev=16,t.serverConfig=JSON.parse(t.serverConfig),i.next=24;break;case 20:return i.prev=20,i.t0=i["catch"](16),e.$message.error("服务配置必须是 JSON 格式"),i.abrupt("return");case 24:if(window.__TAURI__&&window.__TAURI__.invoke){i.next=27;break}return e.$message.error("必须使用 Tauri 客户端打开此页面"),i.abrupt("return");case 27:return i.next=29,window.__TAURI__.invoke("check_java",{javaPath:t.javaPath||""})["catch"]((function(i){return e.$message.error("未检测到 Java 运行环境，请确认 Java 路径设置是否正确 "+i),!1}));case 29:if(o=i.sent,o){i.next=32;break}return i.abrupt("return");case 32:return i.next=34,window.__TAURI__.invoke("save_config",{config:t})["catch"]((function(i){return e.$message.error("配置保存失败"+i),!1}));case 34:if(n=i.sent,n){i.next=37;break}return i.abrupt("return");case 37:window.__TAURI__.process.relaunch();case 38:case"end":return i.stop()}}),i,null,[[16,20]])})))()}},watch:{collapseMenu:function(e){e?this.showNavigation||(this.navigationClass="navigation-hidden"):this.navigationClass=""},showNavigation:function(e){var i=this;e?this.navigationClass="navigation-in":(this.navigationClass="navigation-out",setTimeout((function(){i.navigationClass="navigation-hidden"}),300))}}},w=l,u=(t("e976"),t("d273"),t("2877")),h=Object(u["a"])(w,o,n,!1,null,"532b5ff6",null);i["default"]=h.exports},"826d":function(e,i,t){},d273:function(e,i,t){"use strict";t("e8da")},e8da:function(e,i,t){},e976:function(e,i,t){"use strict";t("826d")}}]);