(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["setting"],{"347a":function(i,e,t){"use strict";t("3ffa")},"3ffa":function(i,e,t){},"4ef5":function(i,e,t){"use strict";t.r(e);var o=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"setting-wrapper",class:{night:i.isNight,day:!i.isNight}},[t("div",{staticClass:"navigation-wrapper",class:[i.navigationClass,i.isWebApp&&!i.isNight?"status-bar-light-bg":""],style:i.navigationStyle,on:{touchstart:i.handleTouchStart,touchmove:i.handleTouchMove,touchend:i.handleTouchEnd}},[t("div",{staticClass:"navigation-inner-wrapper"},[t("div",{staticClass:"navigation-title"},[i._v(" 阅读 "),t("span",{staticClass:"version-text"},[i._v(i._s(i.$store.state.version))])]),t("div",{staticClass:"navigation-sub-title"},[i._v(" 清风不识字，何故乱翻书 ")])])]),t("div",{ref:"shelfWrapper",staticClass:"setting-zone-wrapper",class:i.isWebApp&&!i.isNight?"status-bar-light-bg":"",on:{click:i.hideMenu}},[t("div",{staticClass:"setting-zone-title"},[i.$store.getters.isNormalPage&&i.collapseMenu?t("i",{staticClass:"el-icon-menu",on:{click:function(e){return e.stopPropagation(),i.toggleMenu.apply(null,arguments)}}}):i._e(),i._v(" 设置 "),t("div",{staticClass:"title-btn",on:{click:i.backToShelf}},[i._v(" 书架 ")])]),t("div",{staticClass:"setting-form-wrapper"},[t("el-form",{attrs:{model:i.windowConfigForm,"label-width":i.collapseMenu?"auto":"95px"}},[t("el-form-item",{attrs:{label:"Java路径"}},[t("el-input",{model:{value:i.windowConfigForm.javaPath,callback:function(e){i.$set(i.windowConfigForm,"javaPath",e)},expression:"windowConfigForm.javaPath"}})],1),t("el-form-item",{attrs:{label:"服务端口"}},[t("el-input",{model:{value:i.windowConfigForm.serverPort,callback:function(e){i.$set(i.windowConfigForm,"serverPort",e)},expression:"windowConfigForm.serverPort"}})],1),t("el-form-item",{attrs:{label:"服务配置"}},[t("el-input",{attrs:{type:"textarea",rows:5},model:{value:i.windowConfigForm.serverConfig,callback:function(e){i.$set(i.windowConfigForm,"serverConfig",e)},expression:"windowConfigForm.serverConfig"}})],1),t("el-form-item",{attrs:{label:"窗口宽度"}},[t("el-input",{model:{value:i.windowConfigForm.width,callback:function(e){i.$set(i.windowConfigForm,"width",e)},expression:"windowConfigForm.width"}})],1),t("el-form-item",{attrs:{label:"窗口高度"}},[t("el-input",{model:{value:i.windowConfigForm.height,callback:function(e){i.$set(i.windowConfigForm,"height",e)},expression:"windowConfigForm.height"}})],1),t("el-form-item",{attrs:{label:"横坐标"}},[t("el-input",{model:{value:i.windowConfigForm.positionX,callback:function(e){i.$set(i.windowConfigForm,"positionX",e)},expression:"windowConfigForm.positionX"}})],1),t("el-form-item",{attrs:{label:"纵坐标"}},[t("el-input",{model:{value:i.windowConfigForm.positionY,callback:function(e){i.$set(i.windowConfigForm,"positionY",e)},expression:"windowConfigForm.positionY"}})],1),t("el-form-item",{attrs:{label:"调试页面"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":!0,"inactive-value":!1},model:{value:i.windowConfigForm.debug,callback:function(e){i.$set(i.windowConfigForm,"debug",e)},expression:"windowConfigForm.debug"}})],1),t("el-form-item",{attrs:{label:"其他配置"}},[t("el-checkbox",{model:{value:i.windowConfigForm.rememberSize,callback:function(e){i.$set(i.windowConfigForm,"rememberSize",e)},expression:"windowConfigForm.rememberSize"}},[i._v("记住窗口大小")]),t("el-checkbox",{model:{value:i.windowConfigForm.setWindowSize,callback:function(e){i.$set(i.windowConfigForm,"setWindowSize",e)},expression:"windowConfigForm.setWindowSize"}},[i._v("启动时设置窗口大小")]),t("el-checkbox",{model:{value:i.windowConfigForm.rememberPosition,callback:function(e){i.$set(i.windowConfigForm,"rememberPosition",e)},expression:"windowConfigForm.rememberPosition"}},[i._v("记住窗口位置")]),t("el-checkbox",{model:{value:i.windowConfigForm.setWindowPosition,callback:function(e){i.$set(i.windowConfigForm,"setWindowPosition",e)},expression:"windowConfigForm.setWindowPosition"}},[i._v("启动时设置窗口位置")])],1),t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:i.saveConfig}},[i._v("保存并重启")])],1)],1)],1)])])},n=[],a=t("c7eb"),s=t("1da1"),r=t("5530"),c=(t("e9c4"),t("ac1f"),t("5319"),t("4795"),t("2f62")),l={data:function(){return{showNavigation:!1,navigationClass:"",navigationStyle:{},windowConfigForm:{javaPath:"",serverPort:8080,width:1280,height:800,rememberSize:!0,rememberPosition:!1,setWindowSize:!0,setWindowPosition:!1,serverConfig:"{\n\n}"}}},created:function(){var i=this;window.__TAURI__&&window.__TAURI__.invoke&&window.__TAURI__.invoke("get_config").then((function(e){e.serverConfig=JSON.stringify(e.serverConfig,null,4),i.windowConfigForm=Object(r["a"])({},e)}))["catch"]((function(){})),window.settingPage=this,this.navigationClass=this.collapseMenu&&!this.showNavigation?"navigation-hidden":""},computed:Object(r["a"])({},Object(c["b"])(["isNight","collapseMenu"])),methods:{handleTouchStart:function(i){this.lastTouch=!1,this.lastMoveX=!1,this.touchMoveTimes=0,i.touches&&i.touches[0]&&i.touches[0].clientX>20&&i.touches[0].clientX<window.innerWidth-20&&i.touches[0].clientY>20&&i.touches[0].clientY<window.innerHeight-20&&(this.lastTouch=i.touches[0])},handleTouchMove:function(i){if(i.touches&&i.touches[0]&&this.lastTouch&&this.collapseMenu){var e=i.touches[0].clientX-this.lastTouch.clientX,t=i.touches[0].clientY-this.lastTouch.clientY;if(Math.abs(t)>Math.abs(e))return this.navigationStyle={},void(this.lastMoveX=0);i.preventDefault(),i.stopPropagation(),!this.showNavigation&&e>0&&e<=270?(this.touchMoveTimes%3===0&&(this.navigationStyle={marginLeft:e-270+"px"}),this.lastMoveX=e):this.showNavigation&&e<0&&e>=-270&&(this.touchMoveTimes%3===0&&(this.navigationStyle={marginLeft:e+"px"}),this.lastMoveX=e),this.touchMoveTimes++}},handleTouchEnd:function(){this.collapseMenu&&(this.lastMoveX>0?(this.showNavigation=!0,this.navigationStyle={}):this.lastMoveX<0&&(this.showNavigation=!1,this.navigationStyle={}))},hideMenu:function(){this.$store.getters.isNormalPage&&this.collapseMenu&&(this.showNavigation=!1)},toggleMenu:function(){this.collapseMenu&&(this.showNavigation=!this.showNavigation)},backToShelf:function(){var i=this;return Object(s["a"])(Object(a["a"])().mark((function e(){var t;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!window.__TAURI__||!window.__TAURI__.invoke){e.next=6;break}return e.next=3,window.__TAURI__.invoke("check_java",{javaPath:i.windowConfigForm.javaPath||""})["catch"]((function(e){return i.$message.error("未检测到 Java 运行环境，请确认 Java 路径设置是否正确 "+e),!1}));case 3:if(t=e.sent,t){e.next=6;break}return e.abrupt("return");case 6:i.$router.replace("/");case 7:case"end":return e.stop()}}),e)})))()},saveConfig:function(){var i=this;return Object(s["a"])(Object(a["a"])().mark((function e(){var t,o,n;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object(r["a"])({},i.windowConfigForm),e.prev=1,t.serverConfig=JSON.parse(t.serverConfig),e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](1),i.$message.error("服务配置必须是 JSON 格式"),e.abrupt("return");case 9:if(window.__TAURI__&&window.__TAURI__.invoke){e.next=12;break}return i.$message.error("必须使用 Tauri 客户端打开此页面"),e.abrupt("return");case 12:return e.next=14,window.__TAURI__.invoke("check_java",{javaPath:t.javaPath||""})["catch"]((function(e){return i.$message.error("未检测到 Java 运行环境，请确认 Java 路径设置是否正确 "+e),!1}));case 14:if(o=e.sent,o){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,window.__TAURI__.invoke("save_config",{config:t})["catch"]((function(e){return i.$message.error("配置保存失败"+e),!1}));case 19:if(n=e.sent,n){e.next=22;break}return e.abrupt("return");case 22:window.__TAURI__.process.relaunch();case 23:case"end":return e.stop()}}),e,null,[[1,5]])})))()}},watch:{collapseMenu:function(i){i?this.showNavigation||(this.navigationClass="navigation-hidden"):this.navigationClass=""},showNavigation:function(i){var e=this;i?this.navigationClass="navigation-in":(this.navigationClass="navigation-out",setTimeout((function(){e.navigationClass="navigation-hidden"}),300))}}},u=l,h=(t("347a"),t("d273"),t("2877")),w=Object(h["a"])(u,o,n,!1,null,"01dfd328",null);e["default"]=w.exports},d273:function(i,e,t){"use strict";t("e8da")},e8da:function(i,e,t){}}]);